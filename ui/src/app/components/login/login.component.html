<div class="page-container">
  <div class="card">
    <h1>Welcome</h1>
    <p class="subtitle">Track your racket stringings</p>

  <div class="tabs">
    <button
      class="tab"
      [class.active]="activeTab === 'login'"
      (click)="setActiveTab('login')"
    >
      Login
    </button>
    <button
      class="tab"
      [class.active]="activeTab === 'register'"
      (click)="setActiveTab('register')"
    >
      Register
    </button>
  </div>

  <!-- Login Form -->
  <form *ngIf="activeTab === 'login'" (ngSubmit)="onLogin()">
    <div class="form-group">
      <label for="loginUsername">Username</label>
      <input
        type="text"
        id="loginUsername"
        [(ngModel)]="loginData.username"
        name="username"
                [class.invalid]="submitted && !loginData.username"
      />
      <div class="error-message" *ngIf="submitted && !loginData.username">
        Username is required
      </div>
    </div>

    <div class="form-group">
      <label for="loginPassword">Password</label>
      <div class="password-input-wrapper">
        <input
          [type]="showLoginPassword ? 'text' : 'password'"
          id="loginPassword"
          [(ngModel)]="loginData.password"
          name="password"
          [class.invalid]="submitted && !loginData.password"
        />
        <button type="button" class="password-toggle" (click)="toggleLoginPassword()">
          <mat-icon>{{ showLoginPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </div>
      <div class="error-message" *ngIf="submitted && !loginData.password">
        Password is required
      </div>
    </div>

    <button type="submit" [disabled]="isLoading">
      <span *ngIf="isLoading" class="loading"></span>
      {{ isLoading ? 'Logging in...' : 'Login' }}
    </button>
  </form>

  <!-- Register Form -->
  <form *ngIf="activeTab === 'register'" (ngSubmit)="onRegister()">
    <div class="form-row">
      <div class="form-group">
        <label for="givenName">First Name</label>
        <input
          type="text"
          id="givenName"
          [(ngModel)]="registerData.givenName"
          name="givenName"
                    [class.invalid]="submitted && !registerData.givenName"
        />
        <div class="error-message" *ngIf="submitted && !registerData.givenName">
          First name is required
        </div>
      </div>

      <div class="form-group">
        <label for="familyName">Last Name</label>
        <input
          type="text"
          id="familyName"
          [(ngModel)]="registerData.familyName"
          name="familyName"
                    [class.invalid]="submitted && !registerData.familyName"
        />
        <div class="error-message" *ngIf="submitted && !registerData.familyName">
          Last name is required
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="email">Email</label>
      <input
        type="email"
        id="email"
        [(ngModel)]="registerData.email"
        name="email"
                [class.invalid]="submitted && (!registerData.email || !isValidEmail(registerData.email))"
      />
      <div class="error-message" *ngIf="submitted && !registerData.email">
        Email is required
      </div>
      <div class="error-message" *ngIf="submitted && registerData.email && !isValidEmail(registerData.email)">
        Please enter a valid email address
      </div>
    </div>

    <div class="form-group">
      <label for="username">Username</label>
      <input
        type="text"
        id="username"
        [(ngModel)]="registerData.username"
        name="username"
                [class.invalid]="submitted && !registerData.username"
      />
      <div class="error-message" *ngIf="submitted && !registerData.username">
        Username is required
      </div>
    </div>

    <div class="form-group">
      <label for="birthday">Birthday</label>
      <input
        type="date"
        id="birthday"
        [(ngModel)]="registerData.birthday"
        name="birthday"
        [class.invalid]="submitted && !registerData.birthday"
      />
      <div class="error-message" *ngIf="submitted && !registerData.birthday">
        Birthday is required
      </div>
    </div>

    <div class="form-group">
      <label for="password">Password</label>
      <div class="password-input-wrapper">
        <input
          [type]="showRegisterPassword ? 'text' : 'password'"
          id="password"
          [(ngModel)]="registerData.password"
          name="password"
          [class.invalid]="submitted && !registerData.password"
        />
        <button type="button" class="password-toggle" (click)="toggleRegisterPassword()">
          <mat-icon>{{ showRegisterPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </div>
      <div class="error-message" *ngIf="submitted && !registerData.password">
        Password is required
      </div>
    </div>

    <div class="form-group checkbox-group">
      <mat-checkbox [(ngModel)]="registerData.isStringer" name="isStringer">
        I am a stringer (I string rackets for others)
      </mat-checkbox>
    </div>

    <button type="submit" [disabled]="isLoading">
      <span *ngIf="isLoading" class="loading"></span>
      {{ isLoading ? 'Creating account...' : 'Create Account' }}
    </button>
  </form>

  <div class="error-card" *ngIf="errorMessage">
    ‚ùå {{ errorMessage }}
  </div>
  </div>
</div>
